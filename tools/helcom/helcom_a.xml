<tool id="helcom_annual_indicators" name="Annual Indicators (1)" version="0.1.0">
    <description>Get Annual Indicators from HELCOM HEAT, as csv.</description>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <requirements>
        <requirement type="package">geojson</requirement>
        <requirement type="package">requests</requirement>
    </requirements>
    <command><![CDATA[
        python $__tool_directory__/wrap_helcom_a.py --ogc_service_url $service_access.ogc_service_url --assessment_period "$assessment_period" --combined_chlorophylla_is_weighted "$combined_chlorophylla_is_weighted"
        #if $service_access.ogc_service_url == 'https://130.225.37.27/pygeoapi':
            --username $username --password $password
        #end if
        --output $annual_indicators_csv
    ]]></command>
    <inputs>
        <conditional name="service_access">
            <param name="ogc_service_url" type="select" label="OGC API: Which URL to request, including port." value="http://130.225.37.27:5000">
                <option value="http://130.225.37.27:5000">http://130.225.37.27:5000</option>
                <option value="https://130.225.37.27/pygeoapi">https://130.225.37.27/pygeoapi</option>
            </param>
            <when value="https://130.225.37.27/pygeoapi">
                <param name="username" type="text" label="Username"/>
                <param name="password" type="text" label="Password"/>
            </when>
        </conditional>
        <param name="assessment_period" type="select" label="Which HELCOM assessment period...">
            <option value="2011-2016">2011-2016</option>
            <option value="1877-9999">1877-9999</option>
            <option value="2016-2021">2016-2021</option>
        </param>
        <param name="combined_chlorophylla_is_weighted" type="select" label="Something about chlorophyll...">
            <option value="true">True</option>
            <option value="false">False</option>
        </param>
    </inputs>
    <outputs>
        <data name="annual_indicators_csv" label="Annual_Indicators.csv" format="csv" />
    </outputs>
    <tests>
        <test>
            <!--<output name="galaxy_output" file="/galaxy/tools/mytools/test_data/test_output.txt"/>-->
        </test>
    </tests>
    <help><![CDATA[
        Run the first steps of HELCOM Eutrophication Assessment Tool (HEAT, see https://github.com/ices-tools-prod/HEAT), until creation of Annual_Indicators.csv.
    ]]></help>
    <citations>
        <citation type="bibtex">
            @Manual{,
                title = {httr2: Perform HTTP Requests and Process the Responses},
                author = {Hadley Wickham},
                year = {2023},
                note = {R package version 0.2.3},
                url = {https://CRAN.R-project.org/package=httr2},
            }
        </citation>
    </citations>
</tool>
